<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Dashboard | Research Portal, IITK</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <!-- VENDOR CSS -->
    <link
      rel="stylesheet"
      href="/dash/assets/vendor/bootstrap/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="/dash/assets/vendor/font-awesome/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/dash/assets/vendor/linearicons/style.css" />
    <link
      rel="stylesheet"
      href="/dash/assets/vendor/chartist/css/chartist-custom.css"
    />
    <!-- MAIN CSS -->
    <link rel="stylesheet" href="/dash/assets/css/main.css" />
    <!-- GOOGLE FONTS -->
    <link
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700"
      rel="stylesheet"
    />
    <!-- ICONS -->
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/dash/assets/img/apple-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="/dash/assets/img/favicon.png"
    />
    <style>
      #pickFile {
        background: transparent;
        color: #00a0f0;
        border: 1px solid #00a0f0;
        box-shadow: none;
        margin-right: 10px;
        transition: all 0.05s ease-in-out;
      }
      #pickFile:hover {
        transform: scale(1.02);
      }
      #nativePick {
        width: 0;
        height: 0;
      }
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery.form/3.51/jquery.form.min.js"></script>
  </head>

  <body>
    <!-- WRAPPER -->
    <div id="wrapper">
      <!-- NAVBAR -->
      <nav class="navbar navbar-default navbar-fixed-top">
        <div class="brand">
          <a href="/home/"
            ><img
              src="/dash/assets/img/logo-dark.png"
              alt="AnC Logo"
              class="img-responsive logo"
          /></a>
        </div>
        <div class="container-fluid">
          <div class="navbar-btn">
            <button type="button" class="btn-toggle-fullwidth">
              <i class="lnr lnr-arrow-left-circle"></i>
            </button>
          </div>
          <div id="navbar-menu">
            <ul class="nav navbar-nav navbar-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                  ><i class="lnr lnr-link"></i> <span>Quick Links</span>
                  <i class="icon-submenu lnr lnr-chevron-down"></i
                ></a>
                <ul class="dropdown-menu">
                  <li><a href="https://iitk.ac.in"target="_blank">IITK Home</a></li>
                  <li><a href="https://iitk.ac.in/dosa"target="_blank">DOSA</a></li>
                  <li><a href="https://iitk.ac.in/doaa"target="_blank">DOAA</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                  ><img
                    src="https://oa.cc.iitk.ac.in:443/Oa/Jsp/Photo/<%=student.rollNumber%>_0.jpg"
                    class="img-circle"
                    alt="Avatar"/>
                  <span><%= student.name %></span>
                  <i class="icon-submenu lnr lnr-chevron-down"></i
                ></a>
                <ul class="dropdown-menu">
                  <li>
                    <a href="/home/student/profile/"
                      ><i class="lnr lnr-user"></i> <span>My Profile</span></a
                    >
                  </li>
                  <li>
                    <a href="/home/profile/changepwd/"
                      ><i class="lnr lnr-cog"></i>
                      <span>Change Password</span></a
                    >
                  </li>
                  <li>
                    <a href="/home/user/logout"
                      ><i class="lnr lnr-exit"></i> <span>Logout</span></a
                    >
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- END NAVBAR -->
      <!-- LEFT SIDEBAR -->
      <div id="sidebar-nav" class="sidebar">
        <div class="sidebar-scroll">
          <nav>
            <ul class="nav">
              <li>
                <a href="/home/" class=""
                  ><i class="lnr lnr-home"></i> <span>Dashboard</span></a
                >
              </li>
              <li>
                <a href="/project" class=""
                  ><i class="lnr lnr-list"></i> <span>All Projects</span></a
                >
              </li>
              <li>
                <a href="/project/self" class=""
                  ><i class="lnr lnr-pushpin"></i> <span>Your Projects</span></a
                >
              </li>
              <li>
                <a href="/home/student/profile" class="active"
                  ><i class="lnr lnr-user"></i><span>Profile</span></a
                >
              </li>
            </ul>
          </nav>
        </div>
      </div>
      <!-- END LEFT SIDEBAR -->
      <!-- MAIN -->
      <div class="main">
        <!-- MAIN CONTENT -->
        <div class="main-content">
          <div class="container-fluid" id="alert-wrap">
            <div class="panel panel-profile">
              <div class="clearfix">
                <!-- LEFT COLUMN -->
                <div
                  class="profile-left"
                  style="display: flex; align-items: center; justify-content: center"
                >
                  <!-- PROFILE HEADER -->
                  <!-- <div class="profile-header"> -->
                  <img
                    src="https://oa.cc.iitk.ac.in:443/Oa/Jsp/Photo/<%=student.rollNumber%>_0.jpg"
                    style="width: 250px; height: 300px"
                    alt="No image found"
                  />
                  <!-- </div> -->
                </div>
                <!-- END PROFILE HEADER -->
                <!-- PROFILE DETAIL -->
                <div class="profile-right">
                  <div class="profile-detail">
                    <div class="profile-info">
                      <h4 class="heading">Basic Info</h4>
                      <ul class="list-unstyled list-justify">
                        <li>Name <span><%=student.name%></span></li>
                        <li>
                          Roll Number <span><%=student.rollNumber%></span>
                        </li>
                        <li>Email <span><%=student.email%></span></li>
                        <li>Department <span><%=student.department%></span></li>
                      </ul>
                      <br /><br />
                      <h4 class="heading">Resume</h4>
                      <span>
                        <%if(student.resume){%>
                        <a href="/home/resume" target = "_blank">Your resume</a>
                        <%}else{%>
                        <strong>You have not uploaded your resume.</strong>
                        <%}%>
                      </span>
                      <br />
                      <br />
                      <form
                        id="uploadForm"
                        enctype="multipart/form-data"
                        method="post"
                        action="/home/student/profile"
                      >
                        <button class="btn btn-primary" id="pickFile">
                          Choose File
                        </button>
                        <label id="fileName">No file chosen</label>
                        <input
                          id="nativePick"
                          type="file"
                          name="resume"
                          required
                        /><br />
                        <%if(!student.resume){%>
                        <button
                          class="btn btn-primary"
                          type="submit"
                          value="Upload resume"
                          name="submit"
                        >
                          Upload resume
                        </button>
                        <%}else{%>
                        <button
                          class="btn btn-primary"
                          type="submit"
                          value="Update resume"
                          name="submit"
                        >
                          Update resume
                        </button>
                        <%}%>
                      </form>
                    </div>
                  </div>
                </div>
                <!-- END PROFILE DETAIL -->
                <!-- </div> -->
                <!-- END LEFT COLUMN -->
                <!-- RIGHT COLUMN -->

                <!-- END RIGHT COLUMN -->
              </div>
            </div>
          </div>
        </div>
        <!-- END MAIN CONTENT -->
      </div>
      <!-- END MAIN -->
      <div class="clearfix"></div>
      <footer>
        <div class="container-fluid">
          <p class="copyright">
            &copy; Academics and Career Council, IIT Kanpur
          </p>
        </div>
      </footer>
    </div>
    <!-- END WRAPPER -->
    <!-- Javascript -->
    <script src="/dash/assets/vendor/jquery/jquery.min.js"></script>
    <script src="/dash/assets/vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="/dash/assets/vendor/jquery-slimscroll/jquery.slimscroll.min.js"></script>
    <script src="/dash/assets/scripts/klorofil-common.js"></script>
    <script src="/dash/assets/scripts/alerts.js"></script>
    <script>
      const form = document.querySelector('#uploadForm');
      const customBtn = document.querySelector('#pickFile');
      const nativeBtn = document.querySelector('#nativePick');
      const label = document.querySelector('#fileName');
      const container = document.querySelector('#alert-wrap');

      customBtn.addEventListener('click', () => nativeBtn.click());
      nativeBtn.addEventListener('change', obj => {
        const fileName = obj.target.value.split('\\');
        label.innerHTML = fileName[fileName.length - 1];
      });

      form.addEventListener('submit', e => {
        e.preventDefault();
        $.ajax({
          url: '/home/student/profile',
          method: 'POST',
          processData: false,
          contentType: false,
          data: new FormData(form),
          success: () =>
            addAlert(container, 'success', 'Resume uploaded successfully!'),
          error: () =>
            addAlert(
              container,
              'error',
              'An unexpected error occured. Try again later.'
            )
        });
      });
    </script>
  </body>
</html>
